<%if logged_in?%><% unless has_nickname?(current_user)%><script type="text/javascript">$(document).ready(function(){	disable_form();	$("#nick-blank-save").click(function() {changeNick ()});});function changeNick ()  {		var userName = $("#nick-blank").val();		if (userName.length < 2){			alertWrongNick(2);		} else if (userName.length >50){			alertWrongNick(3);		} else {			$.post("/update_nick", { user_name: userName} );		}}function alertWrongNick(status) {			var msg = '';			if (status==1) msg = $('#nick-error-msg1').text();			if (status==2) msg = $('#nick-error-msg2').text();			if (status==3) msg = $('#nick-error-msg3').text();			$('<div title="Invalid nickname" style="padding: 30px 60px; font-size: 12px;"><b>'+msg+'</b></div>').dialog({modal:true}).dialog( "option", "buttons", {"Ok": function() { $(this).dialog("close"); } } );}function userNameChanging(status,name) {	$("#username .err-block, #username .nick-error-msg").hide();	$(".username-dial .ui-dialog-buttonset img.up-loader").remove();	if (status == 0) {		var to_show = $("#un-success")		if ($("#nick-blank-save").is(":visible")) {var to_show = $("#un-success1")}		$("#current_name").text(name);		$("#us-nickname").val(name)		$("#username").dialog("close");		$("#nick-blank").val(name); 		$("#us-username").html(name)		to_show.show();		setTimeout(function() {			to_show.fadeOut(800, function() {to_show.hide()});		}, 1000)		enable_form();			} else {		$("#username .err-block").fadeIn();		if (status==1) {			if ($("#nick-blank-save").is(":visible"))  {alertWrongNick(1); $("#username .err-block").hide();}			else {$("#nick-error-msg1").show();}		} else if (status==3) {			$("#nick-error-msg3").show();		} else {			$("#nick-error-msg2").show();		}	}}</script>	<div class="ui-state-highlight ui-corner-all" style="padding: 0 .7em;"> 		<p>			<span class="ui-icon ui-icon-info" style="float: left; margin-right: .3em;"></span> 			<span style="font-size: 11px"><strong>Attention!</strong> 				You can post new topics and comments only after you enter your nickname</span>		</p><div id="current_user_name" style="padding: 10px 30px 15px 20px; color: #444; line-height: 28px;"><b>Nickname:</b> <span id="us-username"><input placeholder="enter a nickname" style="width: 200px" id="nick-blank"><input id="nick-blank-save" type="button" value="save"></span><span id="un-success1">&#10004; Saved</span></div>			</div><br><div style="display: none"><span id="nick-error-msg1" class="nick-error-msg">Nickname is already taken</span><span id="nick-error-msg2" class="nick-error-msg">Invalid nickname</span><span id="nick-error-msg3" class="nick-error-msg">Nickname is too long <span="white-space:nowrap;">(maximum 50 symbols)</span></span></div><%end%><%end%>